<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Compost Adjacent</title>
<meta name="description" content="Compost Adjacent — cosmic compost transmissions" />
<link rel="icon" href="data:image/svg+xml;utf8,
  %3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3Cfilter id='g'%3E%3CfeGaussianBlur stdDeviation='3'/%3E%3C/filter%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='%23050505'/%3E%3Cpath d='M8 36c4-10 12-12 20-10s14 8 20 12 8 6 12 4' stroke='%23ff4fb3' stroke-width='4' stroke-linecap='round' fill='none' filter='url(%23g)'/%3E%3C/svg%3E">

<style>
  /* ===== base + deep dithered background ===== */
  :root{
    --palette: #ff4fb3,#80ffb0,#ffd24a,#ff8a3d,#50f1ff,#ff5b5b;
    --bg-black: #030303;
  }
  html,body{height:100%;margin:0;background:var(--bg-black);font-family:Verdana,Arial,sans-serif;color:#e6f3dd;overflow:hidden;}
  /* SVG noise tiled as subtle dither */
  body::before{
    content:"";
    position:fixed; inset:0; z-index:0;
    background-image: url("data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='64' height='64'%3E%3Cfilter id='t'%3E%3CfeTurbulence baseFrequency='0.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' fill='%23050605'/%3E%3Crect width='100%25' height='100%25' filter='url(%23t)' opacity='0.08' fill='%23000000'/%3E%3C/svg%3E");
    background-repeat: repeat; mix-blend-mode: overlay; opacity:0.9;
    pointer-events:none;
  }

  /* ===== page layout ===== */
  .wrap{position:relative;z-index:4;min-height:100vh; display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding-top:6vh;}
  /* title area */
  h1.site-title{
    margin:0; padding:0; font-size:clamp(36px,7vw,92px); letter-spacing:0.06em; text-transform:uppercase;
    white-space:nowrap; display:inline-block; z-index:5; user-select:none;
    text-shadow: 0 6px 18px rgba(0,0,0,0.6);
  }
  .title-letter{display:inline-block; transform-origin:50% 60%;}
  @keyframes letterWave {
    0%{transform:translateY(0) scale(1)}
    20%{transform:translateY(-12%) scale(1.03)}
    50%{transform:translateY(0) scale(1)}
    80%{transform:translateY(6%) scale(.99)}
    100%{transform:translateY(0) scale(1)}
  }

  /* small hint */
  .hint { color: rgba(220,240,200,0.6); font-family:monospace; font-size:12px; margin-top:8px; z-index:5; }

  /* ===== worm starfield layer (SVG-based tiny worms) ===== */
  .starfield { position:fixed; inset:0; z-index:1; pointer-events:none; overflow:hidden; }
  .tiny-worm {
    position:absolute;
    width:auto; height:auto;
    will-change: transform, opacity;
    transform-origin:center;
  }
  /* wiggle + pulse is done via inline animation randomization for variety */
  .tiny-worm svg { display:block; }
  /* layering slight blur/glow */
  .tiny-worm .core { filter: drop-shadow(0 0 6px rgba(255,255,255,0.06)); }

  /* ===== link buttons (use larger worm svgs) ===== */
  .links { position:fixed; left:24px; bottom:22px; z-index:6; display:flex; gap:14px; align-items:center; }
  .links-right { position:fixed; right:24px; bottom:22px; z-index:6; display:flex; gap:14px; align-items:center; }
  .link-btn {
    width:72px; height:72px; display:inline-grid; place-items:center; border-radius:12px;
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.15));
    box-shadow: 0 10px 30px rgba(0,0,0,0.6), 0 0 12px rgba(255,255,255,0.03);
    border:2px solid rgba(255,255,255,0.04);
    cursor:pointer; text-decoration:none;
    transition: transform .14s ease, box-shadow .14s ease;
  }
  .link-btn:hover{ transform:translateY(-6px); box-shadow:0 18px 44px rgba(0,0,0,0.6); }

  /* ===== spotify player at bottom-center ===== */
  .player-wrap { position:fixed; left:50%; transform:translateX(-50%); bottom:18px; z-index:6; width:min(760px,92%); display:flex; justify-content:center; align-items:center; }
  .player-frame { width:100%; height:80px; border-radius:12px; overflow:hidden; border:2px solid rgba(255,255,255,0.04); box-shadow:0 10px 40px rgba(0,0,0,0.6); }

  /* unmute instruction */
  .unmute-hint { position:fixed; left:50%; transform:translateX(-50%); bottom:110px; z-index:6; font-family:monospace; font-size:12px; color:rgba(220,240,200,0.7); opacity:0.0; transition:opacity .3s; padding:6px 10px; border-radius:6px; background:rgba(0,0,0,0.28); border:1px solid rgba(255,255,255,0.04); }

  /* responsive tweaks */
  @media (max-width:520px){
    .links, .links-right{ bottom:12px; }
    .link-btn{ width:54px; height:54px; }
    .player-wrap{ bottom:10px; height:68px; }
    .player-frame{ height:68px; }
    h1.site-title{ font-size:clamp(26px,10vw,44px); }
  }
</style>
</head>
<body>
  <!-- starfield container -->
  <div class="starfield" id="starfield" aria-hidden="true"></div>

  <!-- main content -->
  <div class="wrap" role="main" aria-labelledby="siteTitle">
    <h1 id="siteTitle" class="site-title" aria-label="COMPOST ADJACENT">COMPOST ADJACENT</h1>
    <div class="hint">worms are the stars ✴︎</div>
  </div>

  <!-- link buttons (larger worm svgs inside buttons) -->
  <div class="links">
    <a class="link-btn" id="spotify-link" href="https://open.spotify.com/artist/4JYHgAnjpihRXtvZ8Qssok" target="_blank" rel="noopener noreferrer" aria-label="Open Spotify">
      <!-- larger worm svg (will color-match) -->
      <svg width="42" height="24" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M5,20 Q25,10 45,20 T85,20 T125,20 T165,20 T195,20" fill="none" stroke="#80ffb0" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </a>
    <a class="link-btn" id="contact-link" href="https://www.instagram.com/compostadjacent/" target="_blank" rel="noopener noreferrer" aria-label="Contact / Instagram">
      <svg width="42" height="24" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M5,20 Q25,10 45,20 T85,20 T125,20 T165,20 T195,20" fill="none" stroke="#ff4fb3" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </a>
  </div>

  <div class="links-right">
    <a class="link-btn" id="ig-link" href="https://www.instagram.com/compostadjacent/" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
      <svg width="42" height="24" viewBox="0 0 200 40" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M5,20 Q25,10 45,20 T85,20 T125,20 T165,20 T195,20" fill="none" stroke="#ff8a3d" stroke-width="6" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </a>
  </div>

  <!-- Spotify player (artist embed). starts at artist, users can click Silly Boy Prance -->
  <div class="player-wrap" id="playerWrap">
    <div class="player-frame">
      <iframe id="spotifyFrame" src="https://open.spotify.com/embed/artist/4JYHgAnjpihRXtvZ8Qssok?utm_source=generator&theme=0"
        width="100%" height="80" frameborder="0" allow="autoplay; encrypted-media; clipboard-write" allowtransparency="true" loading="lazy" title="Compost Adjacent Spotify player"></iframe>
    </div>
  </div>
  <div class="unmute-hint" id="unmuteHint">Click the player to unmute / open in Spotify for full playback</div>

<script>
/* ========== config ========== */
const WORM_TEMPLATES = [
  { id:1, stroke:'#ff4fb3', width:4.8, path:"M5,20 Q25,10 45,20 T85,20 T125,20 T165,20 T195,20" },
  { id:2, stroke:'#80ffb0', width:4.6, path:"M6,20 Q28,12 50,20 T90,20 T130,20 T170,20 T198,20" },
  { id:3, stroke:'#ffd24a', width:4.8, path:"M4,20 Q26,8 48,20 T88,20 T128,20 T168,20 T196,20" },
  { id:4, stroke:'#ff8a3d', width:5.0, path:"M5,20 Q23,12 45,20 T85,20 T125,20 T165,20 T195,20" },
  { id:5, stroke:'#50f1ff', width:4.4, path:"M5,20 Q25,12 45,20 T85,20 T125,20 T165,20 T195,20" },
  { id:6, stroke:'#ff5b5b', width:4.8, path:"M7,20 Q27,9 49,20 T89,20 T129,20 T169,20 T197,20" }
];

const STAR_COUNT = Math.min(260, Math.floor((window.innerWidth*window.innerHeight)/2200)); // density between subtle and medium
const starfield = document.getElementById('starfield');
const palette = WORM_TEMPLATES.map(w=>w.stroke);

/* ========== place non-colliding stars via grid-based packing ==========
   We divide screen into cells and place zero/one worm per cell to avoid collisions.
   Each worm gets a small wriggle animation + slow drift (CSS transform).
======================================================================*/
function createStarfield(){
  starfield.innerHTML = '';
  const cols = Math.max(8, Math.floor(window.innerWidth/120));
  const rows = Math.max(6, Math.floor(window.innerHeight/120));
  const cellW = window.innerWidth / cols;
  const cellH = window.innerHeight / rows;

  const placed = [];
  for(let i=0;i<STAR_COUNT;i++){
    // pick a random cell that isn't used yet (or try a few times)
    let attempts=0;
    let chosen=null;
    while(attempts<8){
      const cx = Math.floor(Math.random()*cols);
      const ry = Math.floor(Math.random()*rows);
      const key = cx+'_'+ry;
      if(!placed.includes(key)){
        placed.push(key);
        chosen={cx,ry};
        break;
      }
      attempts++;
    }
    if(!chosen){
      // fallback random position (no strong collision guarantee)
      chosen = {cx: Math.floor(Math.random()*cols), ry: Math.floor(Math.random()*rows)};
    }

    // randomized small offset within cell so they don't look grid-aligned
    const jitterX = (Math.random()*0.8-0.4) * cellW * 0.6;
    const jitterY = (Math.random()*0.8-0.4) * cellH * 0.6;
    const x = chosen.cx * cellW + cellW*0.5 + jitterX;
    const y = chosen.ry * cellH + cellH*0.5 + jitterY;

    // size small like stars
    const size = 6 + Math.random()*12; // px
    const tpl = WORM_TEMPLATES[Math.floor(Math.random()*WORM_TEMPLATES.length)];
    const rot = (Math.random()*360).toFixed(2);

    // create element
    const div = document.createElement('div');
    div.className='tiny-worm';
    div.style.left = Math.round(x) + 'px';
    div.style.top = Math.round(y) + 'px';
    div.style.width = size + 'px';
    div.style.height = (size*0.45) + 'px';
    div.style.transform = `translate(-50%,-50%) rotate(${rot}deg)`;
    // animation timing randomized
    const driftX = (Math.random()*120 - 60); // px range
    const driftY = (Math.random()*120 - 60);
    const driftDur = 30 + Math.random()*70; // seconds
    const pulseDur = 2.2 + Math.random()*2.6;
    const delay = Math.random()*6;

    // build SVG string for this instance (small, pixel-effect via feTurbulence)
    const svg = `
      <svg viewBox="0 0 200 40" width="${size}" height="${Math.round(size*0.45)}" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs>
          <filter id="g${i}"><feGaussianBlur stdDeviation="2.0" result="b"/><feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          <filter id="grain${i}"><feTurbulence baseFrequency="1.0" numOctaves="1" stitchTiles="stitch"/><feColorMatrix type="saturate" values="0"/><feComponentTransfer><feFuncA type="table" tableValues="0 0.12"/></feComponentTransfer></filter>
        </defs>
        <g filter="url(#g${i})">
          <path class="core" d="${tpl.path}" stroke="${tpl.stroke}" stroke-width="${Math.max(2, tpl.width*(size/12))}" stroke-linecap="round" stroke-linejoin="round" fill="none" />
        </g>
        <rect width="200" height="40" fill="transparent" opacity="0.0"/>
        <rect width="200" height="40" filter="url(#grain${i})" opacity="0.12" />
      </svg>`;

    div.innerHTML = svg;
    // add CSS animation via JS
    div.animate([
      { transform: `translate(-50%,-50%) rotate(${rot}deg) translate(0px,0px)` },
      { transform: `translate(-50%,-50%) rotate(${rot}deg) translate(${driftX/2}px,${driftY/2}px)` },
      { transform: `translate(-50%,-50%) rotate(${rot}deg) translate(${driftX}px,${driftY}px)` }
    ], { duration: driftDur*1000, iterations: Infinity, direction: 'alternate', easing:'ease-in-out', delay: delay*1000 });

    // pulse the inner SVG stroke opacity/blur
    const inner = div.querySelector('.core');
    if(inner){
      inner.style.transition = `filter ${pulseDur}s ease-in-out ${delay}s, opacity ${pulseDur}s ease-in-out ${delay}s`;
      // animate via setInterval-ish but using CSS transitions with toggling class is simpler:
      // toggle opacity with different timings asynchronously
      let step = Math.random()*pulseDur*1000;
      setTimeout(function pulseLoop(){
        inner.style.opacity = 0.65 + Math.random()*0.45;
        inner.style.filter = `drop-shadow(0 0 ${4 + Math.random()*8}px ${tpl.stroke})`;
        step = pulseDur*1000 + (Math.random()*1200-600);
        setTimeout(pulseLoop, step);
      }, step);
    }

    starfield.appendChild(div);
  }
}

/* rebuild on resize */
let resizeTimer;
window.addEventListener('resize', ()=>{ clearTimeout(resizeTimer); resizeTimer=setTimeout(()=>{ createStarfield(); }, 260); });

/* init */
createStarfield();

/* ========== title per-letter colors + wave animation ========== */
(function titleWave(){
  const title = document.getElementById('siteTitle');
  const text = title.textContent.trim();
  title.textContent = '';
  const letters = text.split('');
  const palette = palette = WORM_TEMPLATES.map(w=>w.stroke);
  for(let i=0;i<letters.length;i++){
    const ch = letters[i];
    const span = document.createElement('span');
    span.className='title-letter';
    span.textContent = ch;
    if(ch.trim()){
      // color from palette, cycle
      span.style.color = palette[i % palette.length];
      span.style.textShadow = `0 0 10px ${span.style.color}, 0 14px 26px rgba(0,0,0,0.6)`;
      const delay = (i * 0.06) + (Math.random()*0.04);
      span.style.animation = `letterWave 1.05s cubic-bezier(.2,.8,.2,1) ${delay}s infinite`;
    } else {
      span.style.display='inline-block'; span.style.width='0.5em';
    }
    title.appendChild(span);
  }
})();

/* ========== Player autoplay behavior / unmute hint ==========
   Note: Many browsers block audible autoplay. We load the embed and show the hint.
   If user clicks the iframe, Spotify web player handles playback/unmute. We also
   attempt to call the iframe API via postMessage to play, but Spotify restricts it.
==================================================================*/
const unmuteHint = document.getElementById('unmuteHint');
const spotifyFrame = document.getElementById('spotifyFrame');
// show hint after a second
setTimeout(()=>{ unmuteHint.style.opacity = 1; }, 900);

/* If user interacts anywhere, try to focus iframe (best-effort) */
function tryPlay(){
  try{ spotifyFrame.contentWindow.focus(); }catch(e){}
}
document.addEventListener('click', tryPlay, { once:true, passive:true });

/* remove unmute hint after interaction */
document.addEventListener('click', ()=>{ unmuteHint.style.opacity = 0; }, { once:false, passive:true });

/* ===== ensure larger worm buttons match palette colors dynamically ===== */
(function colorButtons(){
  const btns = document.querySelectorAll('.link-btn svg path');
  const colors = WORM_TEMPLATES.map(w=>w.stroke);
  btns.forEach((p,i)=>{
    const c = colors[i % colors.length];
    p.setAttribute('stroke', c);
  });
})();

</script>
</body>
</html>
